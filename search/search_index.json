{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Aula complementar Azure \u00b6 Bem vindo ao curso de Conceitos b\u00e1sicos de Nuvem com Azure. \u00b6 Professor : Tiago Demay Hor\u00e1rio das aulas : Segunda - 18h - 20h 18/04/2022 Terca - 18h - 20h 19/04/2022 Quarta - 18h - 20h 20/04/2022 Ao final da atividade o aluno ser\u00e1 capaz de: \u00b6 Compreender a utilizacao da CSM (Cloud Service Management) Azure; Entender conceitos de computa\u00e7\u00e3o em nuvem; Compreender os recursos de computacao em nuvem; Criar uma aplica\u00e7\u00e3o Web Python - FLASK; Modificar aplica\u00e7\u00f5es j\u00e1 criadas. Objetivo: \u00b6 Apresentar os conceitos de computacao em nuvem utilizando a CSM (Azure), entregando ao Aluno uma conta Azure e mostrando os passos iniciais. A Prova final \u00e9 individual \u00b6 Brincadeira....... aqui n\u00e3o tem Prova!!!!!!!!!!","title":"Home"},{"location":"#aula-complementar-azure","text":"","title":"Aula complementar Azure"},{"location":"#bem-vindo-ao-curso-de-conceitos-basicos-de-nuvem-com-azure","text":"Professor : Tiago Demay Hor\u00e1rio das aulas : Segunda - 18h - 20h 18/04/2022 Terca - 18h - 20h 19/04/2022 Quarta - 18h - 20h 20/04/2022","title":"Bem vindo ao curso de Conceitos b\u00e1sicos de Nuvem com Azure."},{"location":"#ao-final-da-atividade-o-aluno-sera-capaz-de","text":"Compreender a utilizacao da CSM (Cloud Service Management) Azure; Entender conceitos de computa\u00e7\u00e3o em nuvem; Compreender os recursos de computacao em nuvem; Criar uma aplica\u00e7\u00e3o Web Python - FLASK; Modificar aplica\u00e7\u00f5es j\u00e1 criadas.","title":"Ao final da atividade o aluno ser\u00e1 capaz de:"},{"location":"#objetivo","text":"Apresentar os conceitos de computacao em nuvem utilizando a CSM (Azure), entregando ao Aluno uma conta Azure e mostrando os passos iniciais.","title":"Objetivo:"},{"location":"#a-prova-final-e-individual","text":"Brincadeira....... aqui n\u00e3o tem Prova!!!!!!!!!!","title":"A Prova final \u00e9 individual"},{"location":"sobre/","text":"Burocracias \u00b6 Hor\u00e1rios: As aulas s\u00e3o presenciais, inicio 18hrs at\u00e9 20hrs. Para que possamos seguir com a atividade, \u00e9 necess\u00e1rio a conta de e-mail de Alunos Insper Plano de aulas Data Tema Conte\u00fado/Atividade 18/04/22 Conceitos b\u00e1sicos de Nuvem, acessando o Portal da Azure Entendendo conceito de computacao em nuvem, criando uma conta e passeando pelo CMS 19/04/22 Configurando ambiente e subindo uma aplica\u00e7\u00e3o Web Python- FLASK Instalando Azure CLI, Implementa\u00e7\u00e3o de aplicacao utilizando uma ferramenta de linha de comando multiplataforma 20/04/22 Modificando a aplica\u00e7\u00e3o. aprender a modificar a aplicacao via Dashboard da Azure.","title":"Burocracias"},{"location":"sobre/#burocracias","text":"Hor\u00e1rios: As aulas s\u00e3o presenciais, inicio 18hrs at\u00e9 20hrs. Para que possamos seguir com a atividade, \u00e9 necess\u00e1rio a conta de e-mail de Alunos Insper Plano de aulas Data Tema Conte\u00fado/Atividade 18/04/22 Conceitos b\u00e1sicos de Nuvem, acessando o Portal da Azure Entendendo conceito de computacao em nuvem, criando uma conta e passeando pelo CMS 19/04/22 Configurando ambiente e subindo uma aplica\u00e7\u00e3o Web Python- FLASK Instalando Azure CLI, Implementa\u00e7\u00e3o de aplicacao utilizando uma ferramenta de linha de comando multiplataforma 20/04/22 Modificando a aplica\u00e7\u00e3o. aprender a modificar a aplicacao via Dashboard da Azure.","title":"Burocracias"},{"location":"aulas/01/","text":"01 Introducao \u00b6 Virtualizacao \u00b6 CSM \u00b6 Nuvem? \u00b6 O que \u00e9 o Microsoft Azure? \u00b6 O Azure \u00e9 uma plataforma de computa\u00e7\u00e3o em nuvem lan\u00e7ada pela Microsoft em fevereiro de 2010. \u00c9 uma plataforma de nuvem aberta e flex\u00edvel que auxilia no desenvolvimento, armazenamento de dados, hospedagem de servi\u00e7os e gerenciamento de servi\u00e7os. A ferramenta do Azure hospeda aplicativos Web pela Internet com a ajuda de data centers da Microsoft. Conceitos de chave do Azure \u00b6 Agora, neste tutorial de no\u00e7\u00f5es b\u00e1sicas do Azure, veremos os principais conceitos do Azure, conforme listado abaixo: Nome do conceito Descri\u00e7\u00e3o Regions O Azure \u00e9 uma plataforma de nuvem global que est\u00e1 dispon\u00edvel em v\u00e1rias regi\u00f5es do mundo. Quando voc\u00ea solicita um servi\u00e7o, aplicativo ou VM no Azure, primeiro \u00e9 solicitado que voc\u00ea especifique uma regi\u00e3o. A regi\u00e3o selecionada representa o datacenter onde seu aplicativo \u00e9 executado. Datacenter No Azure, voc\u00ea pode implantar seus aplicativos em v\u00e1rios data centers em todo o mundo. Portanto, \u00e9 aconselh\u00e1vel selecionar uma regi\u00e3o que esteja mais pr\u00f3xima da maioria dos seus clientes. Ele ajuda voc\u00ea a reduzir a lat\u00eancia nas solicita\u00e7\u00f5es de rede. Azure portal O portal do Azure \u00e9 um aplicativo baseado na Web que pode ser usado para criar, gerenciar e remover recursos e servi\u00e7os do Azure. Ele est\u00e1 localizado em https://portal.azure.com . Resources O recurso do Azure \u00e9 um computador individual, dados de rede ou servi\u00e7os de hospedagem de aplicativos cobrados individualmente. Alguns recursos comuns s\u00e3o m\u00e1quinas virtuais (VM), conta de armazenamento ou bancos de dados SQL. Resource groups Um grupo de recursos do Azure \u00e9 um cont\u00eainer que cont\u00e9m recursos relacionados para uma solu\u00e7\u00e3o do Azure. Pode incluir todos os recursos ou apenas recursos que voc\u00ea deseja gerenciar. Azure PowerShell O PowerShell \u00e9 um conjunto de m\u00f3dulos que oferece cmdlets para gerenciar o Azure. Na maioria dos casos, voc\u00ea tem permiss\u00e3o para usar o comando cmdlets para as mesmas tarefas que est\u00e1 executando no portal do Azure. Azure command-line interface(CLI) A CLI do Azure \u00e9 uma ferramenta que voc\u00ea pode usar para criar, gerenciar e remover recursos do Azure da linha de comando. REST APIs O Azure \u00e9 constru\u00eddo em um conjunto de APIs REST que ajudam voc\u00ea a executar a mesma opera\u00e7\u00e3o que voc\u00ea faz no portal do Azure Ul. Ele permite que seus recursos e aplicativos do Azure sejam manipulados por meio de qualquer aplicativo de software de terceiros. Links para criar a Conta \u00b6 link1 link2 link3 link4 Azure para estudantes \u00b6 O Azure for Students permite que voc\u00ea comece com USD 100 em cr\u00e9ditos do Azure para serem usados \u200b\u200bnos primeiros 12 meses, al\u00e9m de alguns servi\u00e7os gratuitos conforme descrito abaixo (servi\u00e7os sujeitos a altera\u00e7\u00f5es) sem a necessidade de um cart\u00e3o de cr\u00e9dito na inscri\u00e7\u00e3o. Aplique aqui -> link Quickstart: Create a Linux virtual machine in the Azure portal \u00b6 Sign in to Azure \u00b6 Sign in to the Azure portal . Create virtual machine \u00b6 Type virtual machines in the search. Under Services , select Virtual machines . In the Virtual machines page, select Create and then Virtual machine . The Create a virtual machine page opens. In the Basics tab, under Project details , make sure the correct subscription is selected and then choose to Create new resource group. Type myResourceGroup for the name.*. Under Instance details , type myVM for the Virtual machine name , and choose Ubuntu 18.04 LTS - Gen2 for your Image . Leave the other defaults. The default size and pricing is only shown as an example. Size availability and pricing are dependent on your region and subscription. :::image type=\"content\" source=\"media/quick-create-portal/instance-details.png\" alt-text=\"Screenshot of the Instance details section where you provide a name for the virtual machine and select its region, image, and size.\"::: [!NOTE] Some users will now see the option to create VMs in multiple zones. To learn more about this new capability, see Create virtual machines in an availability zone . :::image type=\"content\" source=\"../media/create-portal-availability-zone/preview.png\" alt-text=\"Screenshot showing that you have the option to create virtual machines in multiple availability zones.\"::: Under Administrator account , select SSH public key . In Username type azureuser . For SSH public key source , leave the default of Generate new key pair , and then type myKey for the Key pair name . Under Inbound port rules > Public inbound ports , choose Allow selected ports and then select SSH (22) and HTTP (80) from the drop-down. Leave the remaining defaults and then select the Review + create button at the bottom of the page. On the Create a virtual machine page, you can see the details about the VM you are about to create. When you are ready, select Create . When the Generate new key pair window opens, select Download private key and create resource . Your key file will be download as myKey.pem . Make sure you know where the .pem file was downloaded, you will need the path to it in the next step. When the deployment is finished, select Go to resource . On the page for your new VM, select the public IP address and copy it to your clipboard. [!INCLUDE ephemeral-ip-note.md ] Connect to virtual machine \u00b6 Create an SSH connection with the VM. If you are on a Mac or Linux machine, open a Bash prompt. If you are on a Windows machine, open a PowerShell prompt. At your prompt, open an SSH connection to your virtual machine. Replace the IP address with the one from your VM, and replace the path to the .pem with the path to where the key file was downloaded. ssh -i .\\Downloads\\myKey1.pem azureuser@10.111.12.123 [!TIP] The SSH key you created can be used the next time your create a VM in Azure. Just select the Use a key stored in Azure for SSH public key source the next time you create a VM. You already have the private key on your computer, so you won't need to download anything. Install web server \u00b6 To see your VM in action, install the NGINX web server. From your SSH session, update your package sources and then install the latest NGINX package. sudo apt-get -y update sudo apt-get -y install nginx When done, type exit to leave the SSH session. View the web server in action \u00b6 Use a web browser of your choice to view the default NGINX welcome page. Type the public IP address of the VM as the web address. The public IP address can be found on the VM overview page or as part of the SSH connection string you used earlier. Clean up resources \u00b6 When no longer needed, you can delete the resource group, virtual machine, and all related resources. To do so, select the resource group for the virtual machine, select Delete , then confirm the name of the resource group to delete.","title":"01 - Introdu\u00e7\u00e3o"},{"location":"aulas/01/#01-introducao","text":"","title":"01 Introducao"},{"location":"aulas/01/#virtualizacao","text":"","title":"Virtualizacao"},{"location":"aulas/01/#csm","text":"","title":"CSM"},{"location":"aulas/01/#nuvem","text":"","title":"Nuvem?"},{"location":"aulas/01/#o-que-e-o-microsoft-azure","text":"O Azure \u00e9 uma plataforma de computa\u00e7\u00e3o em nuvem lan\u00e7ada pela Microsoft em fevereiro de 2010. \u00c9 uma plataforma de nuvem aberta e flex\u00edvel que auxilia no desenvolvimento, armazenamento de dados, hospedagem de servi\u00e7os e gerenciamento de servi\u00e7os. A ferramenta do Azure hospeda aplicativos Web pela Internet com a ajuda de data centers da Microsoft.","title":"O que \u00e9 o Microsoft Azure?"},{"location":"aulas/01/#conceitos-de-chave-do-azure","text":"Agora, neste tutorial de no\u00e7\u00f5es b\u00e1sicas do Azure, veremos os principais conceitos do Azure, conforme listado abaixo: Nome do conceito Descri\u00e7\u00e3o Regions O Azure \u00e9 uma plataforma de nuvem global que est\u00e1 dispon\u00edvel em v\u00e1rias regi\u00f5es do mundo. Quando voc\u00ea solicita um servi\u00e7o, aplicativo ou VM no Azure, primeiro \u00e9 solicitado que voc\u00ea especifique uma regi\u00e3o. A regi\u00e3o selecionada representa o datacenter onde seu aplicativo \u00e9 executado. Datacenter No Azure, voc\u00ea pode implantar seus aplicativos em v\u00e1rios data centers em todo o mundo. Portanto, \u00e9 aconselh\u00e1vel selecionar uma regi\u00e3o que esteja mais pr\u00f3xima da maioria dos seus clientes. Ele ajuda voc\u00ea a reduzir a lat\u00eancia nas solicita\u00e7\u00f5es de rede. Azure portal O portal do Azure \u00e9 um aplicativo baseado na Web que pode ser usado para criar, gerenciar e remover recursos e servi\u00e7os do Azure. Ele est\u00e1 localizado em https://portal.azure.com . Resources O recurso do Azure \u00e9 um computador individual, dados de rede ou servi\u00e7os de hospedagem de aplicativos cobrados individualmente. Alguns recursos comuns s\u00e3o m\u00e1quinas virtuais (VM), conta de armazenamento ou bancos de dados SQL. Resource groups Um grupo de recursos do Azure \u00e9 um cont\u00eainer que cont\u00e9m recursos relacionados para uma solu\u00e7\u00e3o do Azure. Pode incluir todos os recursos ou apenas recursos que voc\u00ea deseja gerenciar. Azure PowerShell O PowerShell \u00e9 um conjunto de m\u00f3dulos que oferece cmdlets para gerenciar o Azure. Na maioria dos casos, voc\u00ea tem permiss\u00e3o para usar o comando cmdlets para as mesmas tarefas que est\u00e1 executando no portal do Azure. Azure command-line interface(CLI) A CLI do Azure \u00e9 uma ferramenta que voc\u00ea pode usar para criar, gerenciar e remover recursos do Azure da linha de comando. REST APIs O Azure \u00e9 constru\u00eddo em um conjunto de APIs REST que ajudam voc\u00ea a executar a mesma opera\u00e7\u00e3o que voc\u00ea faz no portal do Azure Ul. Ele permite que seus recursos e aplicativos do Azure sejam manipulados por meio de qualquer aplicativo de software de terceiros.","title":"Conceitos de chave do Azure"},{"location":"aulas/01/#links-para-criar-a-conta","text":"link1 link2 link3 link4","title":"Links para criar a Conta"},{"location":"aulas/01/#azure-para-estudantes","text":"O Azure for Students permite que voc\u00ea comece com USD 100 em cr\u00e9ditos do Azure para serem usados \u200b\u200bnos primeiros 12 meses, al\u00e9m de alguns servi\u00e7os gratuitos conforme descrito abaixo (servi\u00e7os sujeitos a altera\u00e7\u00f5es) sem a necessidade de um cart\u00e3o de cr\u00e9dito na inscri\u00e7\u00e3o. Aplique aqui -> link","title":"Azure para estudantes"},{"location":"aulas/01/#quickstart-create-a-linux-virtual-machine-in-the-azure-portal","text":"","title":"Quickstart: Create a Linux virtual machine in the Azure portal"},{"location":"aulas/01/#sign-in-to-azure","text":"Sign in to the Azure portal .","title":"Sign in to Azure"},{"location":"aulas/01/#create-virtual-machine","text":"Type virtual machines in the search. Under Services , select Virtual machines . In the Virtual machines page, select Create and then Virtual machine . The Create a virtual machine page opens. In the Basics tab, under Project details , make sure the correct subscription is selected and then choose to Create new resource group. Type myResourceGroup for the name.*. Under Instance details , type myVM for the Virtual machine name , and choose Ubuntu 18.04 LTS - Gen2 for your Image . Leave the other defaults. The default size and pricing is only shown as an example. Size availability and pricing are dependent on your region and subscription. :::image type=\"content\" source=\"media/quick-create-portal/instance-details.png\" alt-text=\"Screenshot of the Instance details section where you provide a name for the virtual machine and select its region, image, and size.\"::: [!NOTE] Some users will now see the option to create VMs in multiple zones. To learn more about this new capability, see Create virtual machines in an availability zone . :::image type=\"content\" source=\"../media/create-portal-availability-zone/preview.png\" alt-text=\"Screenshot showing that you have the option to create virtual machines in multiple availability zones.\"::: Under Administrator account , select SSH public key . In Username type azureuser . For SSH public key source , leave the default of Generate new key pair , and then type myKey for the Key pair name . Under Inbound port rules > Public inbound ports , choose Allow selected ports and then select SSH (22) and HTTP (80) from the drop-down. Leave the remaining defaults and then select the Review + create button at the bottom of the page. On the Create a virtual machine page, you can see the details about the VM you are about to create. When you are ready, select Create . When the Generate new key pair window opens, select Download private key and create resource . Your key file will be download as myKey.pem . Make sure you know where the .pem file was downloaded, you will need the path to it in the next step. When the deployment is finished, select Go to resource . On the page for your new VM, select the public IP address and copy it to your clipboard. [!INCLUDE ephemeral-ip-note.md ]","title":"Create virtual machine"},{"location":"aulas/01/#connect-to-virtual-machine","text":"Create an SSH connection with the VM. If you are on a Mac or Linux machine, open a Bash prompt. If you are on a Windows machine, open a PowerShell prompt. At your prompt, open an SSH connection to your virtual machine. Replace the IP address with the one from your VM, and replace the path to the .pem with the path to where the key file was downloaded. ssh -i .\\Downloads\\myKey1.pem azureuser@10.111.12.123 [!TIP] The SSH key you created can be used the next time your create a VM in Azure. Just select the Use a key stored in Azure for SSH public key source the next time you create a VM. You already have the private key on your computer, so you won't need to download anything.","title":"Connect to virtual machine"},{"location":"aulas/01/#install-web-server","text":"To see your VM in action, install the NGINX web server. From your SSH session, update your package sources and then install the latest NGINX package. sudo apt-get -y update sudo apt-get -y install nginx When done, type exit to leave the SSH session.","title":"Install web server"},{"location":"aulas/01/#view-the-web-server-in-action","text":"Use a web browser of your choice to view the default NGINX welcome page. Type the public IP address of the VM as the web address. The public IP address can be found on the VM overview page or as part of the SSH connection string you used earlier.","title":"View the web server in action"},{"location":"aulas/01/#clean-up-resources","text":"When no longer needed, you can delete the resource group, virtual machine, and all related resources. To do so, select the resource group for the virtual machine, select Delete , then confirm the name of the resource group to delete.","title":"Clean up resources"},{"location":"aulas/02/","text":"02 \u00b6 Microsoft Azure: Cloud Computing Services https://azure.microsoft.com/en-us/free/ https://azure.microsoft.com/en-us/offers/ms-azr-0170p/ Quickstart: Deploy a Python Flask web app to Azure App Service \u00b6 1 - Sample application \u00b6 This quickstart can be completed using either Flask or Django. A sample application in each framework is provided to help you follow along with this quickstart. Download or clone the sample application to your local workstation. [Flask] \u00b6 git clone https://github.com/Azure-Samples/msdocs-python-flask-webapp-quickstart To run the application locally: [Flask] \u00b6 Go to the application folder: cd msdocs-python-flask-webapp-quickstart Create a virtual environment for the app: [!INCLUDE Virtual environment setup ] Install the dependencies: pip install -r requirements.txt Run the app: flask run Browse to the sample application at http://localhost:5000 in a web browser. :::image type=\"content\" source=\"./media/quickstart-python/run-flask-app-localhost.png\" alt-text=\"Screenshot of the Flask app running locally in a browser\"::: Having issues? Let us know .","title":"02 - Implementando"},{"location":"aulas/02/#02","text":"Microsoft Azure: Cloud Computing Services https://azure.microsoft.com/en-us/free/ https://azure.microsoft.com/en-us/offers/ms-azr-0170p/","title":"02"},{"location":"aulas/02/#quickstart-deploy-a-python-flask-web-app-to-azure-app-service","text":"","title":"Quickstart: Deploy a Python Flask web app to Azure App Service"},{"location":"aulas/02/#1-sample-application","text":"This quickstart can be completed using either Flask or Django. A sample application in each framework is provided to help you follow along with this quickstart. Download or clone the sample application to your local workstation.","title":"1 - Sample application"},{"location":"aulas/02/#flask","text":"git clone https://github.com/Azure-Samples/msdocs-python-flask-webapp-quickstart To run the application locally:","title":"[Flask]"},{"location":"aulas/02/#flask_1","text":"Go to the application folder: cd msdocs-python-flask-webapp-quickstart Create a virtual environment for the app: [!INCLUDE Virtual environment setup ] Install the dependencies: pip install -r requirements.txt Run the app: flask run Browse to the sample application at http://localhost:5000 in a web browser. :::image type=\"content\" source=\"./media/quickstart-python/run-flask-app-localhost.png\" alt-text=\"Screenshot of the Flask app running locally in a browser\"::: Having issues? Let us know .","title":"[Flask]"},{"location":"aulas/03/","text":"03 \u00b6 Apesar de podermos medir o tempo que nosso programa demora usando o comando time , n\u00e3o conseguimos nenhuma informa\u00e7\u00e3o importante de qual parte do programa est\u00e1 consumindo mais tempo. Este processo de dissecar um programa e entender exatamente qual parte demora quanto \u00e9 chamada de Profiling . Software Para esta aula precisaremos dos seguintes pacotes instalados. valgrind - ferramenta de an\u00e1lise de c\u00f3digo execut\u00e1vel kcachegrind - visualizador de resultados do valgrind Warm-up: O problema da soma de uma matriz \u00b6 O c\u00f3digo abaixo apresenta duas formas de realizar a soma de todos os elementos de uma matriz. Compile o c\u00f3digo e execute. Voc\u00ea sabe dizer qual a diferen\u00e7a de naive_sum e improved_sum ? #include <iostream> #include <algorithm> using namespace std ; constexpr int M = 2048 ; constexpr int N = 2048 ; double naive_sum ( const double a [][ N ]){ double sum = 0.0 ; for ( int j = 0 ; j < N ; ++ j ) { for ( int i = 0 ; i < M ; ++ i ) sum += a [ i ][ j ]; } return sum ; } double improved_sum ( const double a [][ N ]) { double sum = 0.0 ; for ( int i = 0 ; i < M ; ++ i ) for ( int j = 0 ; j < N ; ++ j ) sum += a [ i ][ j ]; return sum ; } int main () { static double a [ M ][ N ]; fill_n ( & a [ 0 ][ 0 ], M * N , 1.0 / ( M * N )); cout << naive_sum ( a ) << endl ; static double b [ M ][ N ]; fill_n ( & b [ 0 ][ 0 ], M * N , 1.0 / ( M * N )); cout << improved_sum ( b ) << endl ; return 0 ; } Vamos usar o Valgrind para verificar se h\u00e1 diferen\u00e7as entre naive_sum e improved_sum . Supondo que o seu arquivo se chama sum.cpp execute: g++ -Wall -O3 -g sum.cpp -o sum E execute ent\u00e3o programa via valgrind : valgrind --tool=callgrind ./sum O valgrind ir\u00e1 retornar algo como: ==3079146== Callgrind, a call-graph generating cache profiler ==3079146== Copyright (C) 2002-2017, and GNU GPL'd, by Josef Weidendorfer et al. ==3079146== Using Valgrind-3.15.0 and LibVEX; rerun with -h for copyright info ==3079146== Command: ./sum ==3079146== ==3079146== For interactive control, run 'callgrind_control -h'. 1 1 ==3079146== ==3079146== Events : Ir ==3079146== Collected : 50553796 ==3079146== ==3079146== I refs: 50,553,796 Onde 3079146 \u00e9 o PID da execu\u00e7\u00e3o. Na sua m\u00e1quina ser\u00e1 um outro valor. Ele tamb\u00e9m gerou um arquivo callgrind.out.{PID} . Execute a ferramenta callgrind_annotate para verificar o resultado do profiling. callgrind_annotate callgrind.out.3079146 sum.cpp E seu output ser\u00e1 como segue: -------------------------------------------------------------------------------- Profile data file 'callgrind.out.3079146' (creator: callgrind-3.15.0) -------------------------------------------------------------------------------- I1 cache: D1 cache: LL cache: Timerange: Basic block 0 - 10863316 Trigger: Program termination Profiled target: ./sum (PID 3079146, part 1) Events recorded: Ir Events shown: Ir Event sort order: Ir Thresholds: 99 Include dirs: User annotated: sum.cpp Auto-annotation: off -------------------------------------------------------------------------------- Ir -------------------------------------------------------------------------------- 50,553,796 PROGRAM TOTALS -------------------------------------------------------------------------------- Ir file:function -------------------------------------------------------------------------------- 31,479,818 sum.cpp:main [/home/user/andre/profile/sum] 16,777,221 /usr/include/c++/9/bits/stl_algobase.h:main 948,840 /build/glibc-eX1tMB/glibc-2.31/elf/dl-lookup.c:_dl_lookup_symbol_x [/usr/lib/x86_64-linux-gnu/ld-2.31.so] 554,233 /build/glibc-eX1tMB/glibc-2.31/elf/dl-lookup.c:do_lookup_x [/usr/lib/x86_64-linux-gnu/ld-2.31.so] 273,488 /build/glibc-eX1tMB/glibc-2.31/elf/../sysdeps/x86_64/dl-machine.h:_dl_relocate_object 117,179 /build/glibc-eX1tMB/glibc-2.31/elf/dl-lookup.c:check_match [/usr/lib/x86_64-linux-gnu/ld-2.31.so] -------------------------------------------------------------------------------- -- User-annotated source: sum.cpp -------------------------------------------------------------------------------- Ir . #include<iostream> . #include<algorithm> . using namespace std; . . constexpr int M = 2048; . constexpr int N = 2048; . . double naive_sum(const double a[][N]){ 1 double sum = 0.0; 6,144 for(int j = 0; j < N; ++j) { 12,587,008 for(int i = 0; i < M; ++i) 4,194,304 sum += a[i][j]; . } . return sum; . } . . double improved_sum(const double a[][N]) { 4,097 double sum = 0.0; 8,192 for(int i = 0; i < M; ++i) 4,194,304 for(int j = 0; j < N; ++j) 10,485,760 sum +=a[i][j]; . return sum; . } . 5 int main() { . static double a[M][N]; . fill_n(&a[0][0], M*N, 1.0 / (M*N)); . cout << naive_sum(a) << endl; . static double b[M][N]; . fill_n(&b[0][0], M*N, 1.0 / (M*N)); . cout << improved_sum(b) << endl; . return 0; 6 } -------------------------------------------------------------------------------- Ir -------------------------------------------------------------------------------- 31,479,821 events annotated O que voc\u00ea pode dizer sobre o desempenho do programa? Por que h\u00e1 diferen\u00e7a de instruction fetch (IR) entre naive_sum e improved_sum ? Tip Dica: Verifique a discuss\u00e3o no StackOverflow sobre isso. Neste link https://stackoverflow.com/questions/9936132/why-does-the-order-of-the-loops-affect-performance-when-iterating-over-a-2d-arra Dist\u00e2ncia: Euclides ing\u00eanuo \u00b6 Compile o c\u00f3digo-fonte da implementa\u00e7\u00e3o ing\u00eanua que fizemos na aula passada, com profiling habilitado para medir os tempos de execu\u00e7\u00e3o. g++ -g euclides-ingenuo.cpp -o euclides-ingenuo Ap\u00f3s este passo, execute o programa usando o valgrind com as op\u00e7\u00f5es abaixo. valgrind --tool=callgrind ./seu_exec < entrada > saida Para mostrar os resultados usando o kcachegrind usamos o seguinte comando. kcachegrind callgrind.out.(pid aqui) O que tomou mais tempo de execu\u00e7\u00e3o da vers\u00e3o ing\u00eanua? Medindo os tempos no seu pr\u00f3prio programa \u00b6 Voc\u00ea vai perceber, ao executar a atividade anterior, que boa parte do tempo \u00e9 gasto mostrando a sa\u00edda no terminal. Isto nos leva \u00e0 primeira conclus\u00e3o da atividade de hoje: Entrada e sa\u00edda de dados s\u00e3o opera\u00e7\u00f5es muito lentas Example Fa\u00e7a o teste da demonstra\u00e7\u00e3o em seu pr\u00f3prio programa e anote abaixo, para as duas vers\u00f5es de calcula_distancias , o tempo relativo de execu\u00e7\u00e3o o n\u00famero absoluto de instru\u00e7\u00f5es executadas Question O n\u00famero absoluto de intru\u00e7\u00f5es executadas diminuiu significativamente depois de nossa otimiza\u00e7\u00e3o? Teoricamente s\u00f3 calculamos metade da matriz, esse n\u00famero \u00e9 quase metade da vers\u00e3o n\u00e3o otimizada? Voc\u00ea consegue dizer por que? Resposta Deve ter havido uma diminui\u00e7\u00e3o, mas n\u00e3o chega nem perto de metade. Isso ocorre por v\u00e1rias raz\u00f5es: nosso for duplo continua percorrendo a matriz inteira, apesar de s\u00f3 fazer o c\u00e1lculo em metade das posi\u00e7\u00f5es. alocamos a matriz elemento a elemento enquanto fazemos os c\u00e1lculos. Com isso em mente, vamos agora otimizar a fun\u00e7\u00e3o calcula_distancias . J\u00e1 sabemos que o efeito no tempo final n\u00e3o ser\u00e1 grande. Nosso objetivo ent\u00e3o ser\u00e1 verificar a seguinte afirma\u00e7\u00e3o. Dois algoritmos de mesma complexidade computacional podem ter tempos de execu\u00e7\u00e3o muito diferentes Question A resposta da quest\u00e3o anterior indica que s\u00f3 usar um if para evitar o c\u00e1lculo repetido n\u00e3o \u00e9 suficiente. Precisamos efetivamente fazer um for que percorre s\u00f3 metade da matriz. Supondo que a matriz j\u00e1 esteja inteira alocada, escreva em pseudo-c\u00f3digo como faz\u00ea-lo. Resposta para i=1..N: para j=i..N: DX = X[i] - X[j] DY = Y[i] - Y[j] DIST = sqrt(DX*DX + DY*DY) D[i,j] = DIST D[j,i] = DIST Matrizes (vers\u00e3o 2) \u00b6 Nossa implementa\u00e7\u00e3o usando vector<vector<double>> tem um problema s\u00e9rio: ela aloca elemento a elemento uma estrutura grande que j\u00e1 sabemos o tamanho de in\u00edcio. Seria muito melhor se pud\u00e9ssemos alocar todas as N^2 N^2 posi\u00e7\u00f5es da matriz de uma s\u00f3 vez! Fazemos isso trabalhando com um layout de mem\u00f3ria cont\u00ednuo. Ou seja, armazenaremos a matriz linha a linha como um \u00fanico vetor de tamanho n*n . Temos v\u00e1rias vantagens: tempo de aloca\u00e7\u00e3o de mem\u00f3ria \u00e9 reduzido, j\u00e1 que s\u00f3 fazemos uma chamada podemos acessar qualquer posi\u00e7\u00e3o a qualquer momento melhor desempenho de cache A figura abaixo exemplifica esse layout de mem\u00f3ria: Question Em uma matriz de tamanho 4x7 (4 linhas, 7 colunas), qual \u00e9 o elemento do vetor que representa a posi\u00e7\u00e3o 2x5 (linha 3, coluna 6)? Details Estamos considerando que come\u00e7amos a contar as linhas e colunas do zero. A posi\u00e7\u00e3o do vetor \u00e9 19 . Este n\u00famero \u00e9 obtido pela express\u00e3o i * c + j i \u00e9 a linha a ser acessada j \u00e9 a coluna c \u00e9 o n\u00famero de colunas da matriz 19 = 2 * 7 + 5 Tip Conseguimos redimensionar um vetor usando o m\u00e9todo resize , que recebe o novo n\u00famero de elementos do vetor. Example Fa\u00e7a uma terceira vers\u00e3o de calcula_distancias , desta vez usando o layout de mem\u00f3ria acima. Verifique que o programa continua retornando os mesmos resultados que as vers\u00f5es anteriores. Question Rode novamente os testes de profiling e verifique o n\u00famero de instru\u00e7\u00f5es para esta nova vers\u00e3o. Compare este valor com os anteriores e comente.","title":"03 - Modificando"},{"location":"aulas/03/#03","text":"Apesar de podermos medir o tempo que nosso programa demora usando o comando time , n\u00e3o conseguimos nenhuma informa\u00e7\u00e3o importante de qual parte do programa est\u00e1 consumindo mais tempo. Este processo de dissecar um programa e entender exatamente qual parte demora quanto \u00e9 chamada de Profiling . Software Para esta aula precisaremos dos seguintes pacotes instalados. valgrind - ferramenta de an\u00e1lise de c\u00f3digo execut\u00e1vel kcachegrind - visualizador de resultados do valgrind","title":"03"},{"location":"aulas/03/#warm-up-o-problema-da-soma-de-uma-matriz","text":"O c\u00f3digo abaixo apresenta duas formas de realizar a soma de todos os elementos de uma matriz. Compile o c\u00f3digo e execute. Voc\u00ea sabe dizer qual a diferen\u00e7a de naive_sum e improved_sum ? #include <iostream> #include <algorithm> using namespace std ; constexpr int M = 2048 ; constexpr int N = 2048 ; double naive_sum ( const double a [][ N ]){ double sum = 0.0 ; for ( int j = 0 ; j < N ; ++ j ) { for ( int i = 0 ; i < M ; ++ i ) sum += a [ i ][ j ]; } return sum ; } double improved_sum ( const double a [][ N ]) { double sum = 0.0 ; for ( int i = 0 ; i < M ; ++ i ) for ( int j = 0 ; j < N ; ++ j ) sum += a [ i ][ j ]; return sum ; } int main () { static double a [ M ][ N ]; fill_n ( & a [ 0 ][ 0 ], M * N , 1.0 / ( M * N )); cout << naive_sum ( a ) << endl ; static double b [ M ][ N ]; fill_n ( & b [ 0 ][ 0 ], M * N , 1.0 / ( M * N )); cout << improved_sum ( b ) << endl ; return 0 ; } Vamos usar o Valgrind para verificar se h\u00e1 diferen\u00e7as entre naive_sum e improved_sum . Supondo que o seu arquivo se chama sum.cpp execute: g++ -Wall -O3 -g sum.cpp -o sum E execute ent\u00e3o programa via valgrind : valgrind --tool=callgrind ./sum O valgrind ir\u00e1 retornar algo como: ==3079146== Callgrind, a call-graph generating cache profiler ==3079146== Copyright (C) 2002-2017, and GNU GPL'd, by Josef Weidendorfer et al. ==3079146== Using Valgrind-3.15.0 and LibVEX; rerun with -h for copyright info ==3079146== Command: ./sum ==3079146== ==3079146== For interactive control, run 'callgrind_control -h'. 1 1 ==3079146== ==3079146== Events : Ir ==3079146== Collected : 50553796 ==3079146== ==3079146== I refs: 50,553,796 Onde 3079146 \u00e9 o PID da execu\u00e7\u00e3o. Na sua m\u00e1quina ser\u00e1 um outro valor. Ele tamb\u00e9m gerou um arquivo callgrind.out.{PID} . Execute a ferramenta callgrind_annotate para verificar o resultado do profiling. callgrind_annotate callgrind.out.3079146 sum.cpp E seu output ser\u00e1 como segue: -------------------------------------------------------------------------------- Profile data file 'callgrind.out.3079146' (creator: callgrind-3.15.0) -------------------------------------------------------------------------------- I1 cache: D1 cache: LL cache: Timerange: Basic block 0 - 10863316 Trigger: Program termination Profiled target: ./sum (PID 3079146, part 1) Events recorded: Ir Events shown: Ir Event sort order: Ir Thresholds: 99 Include dirs: User annotated: sum.cpp Auto-annotation: off -------------------------------------------------------------------------------- Ir -------------------------------------------------------------------------------- 50,553,796 PROGRAM TOTALS -------------------------------------------------------------------------------- Ir file:function -------------------------------------------------------------------------------- 31,479,818 sum.cpp:main [/home/user/andre/profile/sum] 16,777,221 /usr/include/c++/9/bits/stl_algobase.h:main 948,840 /build/glibc-eX1tMB/glibc-2.31/elf/dl-lookup.c:_dl_lookup_symbol_x [/usr/lib/x86_64-linux-gnu/ld-2.31.so] 554,233 /build/glibc-eX1tMB/glibc-2.31/elf/dl-lookup.c:do_lookup_x [/usr/lib/x86_64-linux-gnu/ld-2.31.so] 273,488 /build/glibc-eX1tMB/glibc-2.31/elf/../sysdeps/x86_64/dl-machine.h:_dl_relocate_object 117,179 /build/glibc-eX1tMB/glibc-2.31/elf/dl-lookup.c:check_match [/usr/lib/x86_64-linux-gnu/ld-2.31.so] -------------------------------------------------------------------------------- -- User-annotated source: sum.cpp -------------------------------------------------------------------------------- Ir . #include<iostream> . #include<algorithm> . using namespace std; . . constexpr int M = 2048; . constexpr int N = 2048; . . double naive_sum(const double a[][N]){ 1 double sum = 0.0; 6,144 for(int j = 0; j < N; ++j) { 12,587,008 for(int i = 0; i < M; ++i) 4,194,304 sum += a[i][j]; . } . return sum; . } . . double improved_sum(const double a[][N]) { 4,097 double sum = 0.0; 8,192 for(int i = 0; i < M; ++i) 4,194,304 for(int j = 0; j < N; ++j) 10,485,760 sum +=a[i][j]; . return sum; . } . 5 int main() { . static double a[M][N]; . fill_n(&a[0][0], M*N, 1.0 / (M*N)); . cout << naive_sum(a) << endl; . static double b[M][N]; . fill_n(&b[0][0], M*N, 1.0 / (M*N)); . cout << improved_sum(b) << endl; . return 0; 6 } -------------------------------------------------------------------------------- Ir -------------------------------------------------------------------------------- 31,479,821 events annotated O que voc\u00ea pode dizer sobre o desempenho do programa? Por que h\u00e1 diferen\u00e7a de instruction fetch (IR) entre naive_sum e improved_sum ? Tip Dica: Verifique a discuss\u00e3o no StackOverflow sobre isso. Neste link https://stackoverflow.com/questions/9936132/why-does-the-order-of-the-loops-affect-performance-when-iterating-over-a-2d-arra","title":"Warm-up: O problema da soma de uma matriz"},{"location":"aulas/03/#distancia-euclides-ingenuo","text":"Compile o c\u00f3digo-fonte da implementa\u00e7\u00e3o ing\u00eanua que fizemos na aula passada, com profiling habilitado para medir os tempos de execu\u00e7\u00e3o. g++ -g euclides-ingenuo.cpp -o euclides-ingenuo Ap\u00f3s este passo, execute o programa usando o valgrind com as op\u00e7\u00f5es abaixo. valgrind --tool=callgrind ./seu_exec < entrada > saida Para mostrar os resultados usando o kcachegrind usamos o seguinte comando. kcachegrind callgrind.out.(pid aqui) O que tomou mais tempo de execu\u00e7\u00e3o da vers\u00e3o ing\u00eanua?","title":"Dist\u00e2ncia: Euclides ing\u00eanuo"},{"location":"aulas/03/#medindo-os-tempos-no-seu-proprio-programa","text":"Voc\u00ea vai perceber, ao executar a atividade anterior, que boa parte do tempo \u00e9 gasto mostrando a sa\u00edda no terminal. Isto nos leva \u00e0 primeira conclus\u00e3o da atividade de hoje: Entrada e sa\u00edda de dados s\u00e3o opera\u00e7\u00f5es muito lentas Example Fa\u00e7a o teste da demonstra\u00e7\u00e3o em seu pr\u00f3prio programa e anote abaixo, para as duas vers\u00f5es de calcula_distancias , o tempo relativo de execu\u00e7\u00e3o o n\u00famero absoluto de instru\u00e7\u00f5es executadas Question O n\u00famero absoluto de intru\u00e7\u00f5es executadas diminuiu significativamente depois de nossa otimiza\u00e7\u00e3o? Teoricamente s\u00f3 calculamos metade da matriz, esse n\u00famero \u00e9 quase metade da vers\u00e3o n\u00e3o otimizada? Voc\u00ea consegue dizer por que? Resposta Deve ter havido uma diminui\u00e7\u00e3o, mas n\u00e3o chega nem perto de metade. Isso ocorre por v\u00e1rias raz\u00f5es: nosso for duplo continua percorrendo a matriz inteira, apesar de s\u00f3 fazer o c\u00e1lculo em metade das posi\u00e7\u00f5es. alocamos a matriz elemento a elemento enquanto fazemos os c\u00e1lculos. Com isso em mente, vamos agora otimizar a fun\u00e7\u00e3o calcula_distancias . J\u00e1 sabemos que o efeito no tempo final n\u00e3o ser\u00e1 grande. Nosso objetivo ent\u00e3o ser\u00e1 verificar a seguinte afirma\u00e7\u00e3o. Dois algoritmos de mesma complexidade computacional podem ter tempos de execu\u00e7\u00e3o muito diferentes Question A resposta da quest\u00e3o anterior indica que s\u00f3 usar um if para evitar o c\u00e1lculo repetido n\u00e3o \u00e9 suficiente. Precisamos efetivamente fazer um for que percorre s\u00f3 metade da matriz. Supondo que a matriz j\u00e1 esteja inteira alocada, escreva em pseudo-c\u00f3digo como faz\u00ea-lo. Resposta para i=1..N: para j=i..N: DX = X[i] - X[j] DY = Y[i] - Y[j] DIST = sqrt(DX*DX + DY*DY) D[i,j] = DIST D[j,i] = DIST","title":"Medindo os tempos no seu pr\u00f3prio programa"},{"location":"aulas/03/#matrizes-versao-2","text":"Nossa implementa\u00e7\u00e3o usando vector<vector<double>> tem um problema s\u00e9rio: ela aloca elemento a elemento uma estrutura grande que j\u00e1 sabemos o tamanho de in\u00edcio. Seria muito melhor se pud\u00e9ssemos alocar todas as N^2 N^2 posi\u00e7\u00f5es da matriz de uma s\u00f3 vez! Fazemos isso trabalhando com um layout de mem\u00f3ria cont\u00ednuo. Ou seja, armazenaremos a matriz linha a linha como um \u00fanico vetor de tamanho n*n . Temos v\u00e1rias vantagens: tempo de aloca\u00e7\u00e3o de mem\u00f3ria \u00e9 reduzido, j\u00e1 que s\u00f3 fazemos uma chamada podemos acessar qualquer posi\u00e7\u00e3o a qualquer momento melhor desempenho de cache A figura abaixo exemplifica esse layout de mem\u00f3ria: Question Em uma matriz de tamanho 4x7 (4 linhas, 7 colunas), qual \u00e9 o elemento do vetor que representa a posi\u00e7\u00e3o 2x5 (linha 3, coluna 6)? Details Estamos considerando que come\u00e7amos a contar as linhas e colunas do zero. A posi\u00e7\u00e3o do vetor \u00e9 19 . Este n\u00famero \u00e9 obtido pela express\u00e3o i * c + j i \u00e9 a linha a ser acessada j \u00e9 a coluna c \u00e9 o n\u00famero de colunas da matriz 19 = 2 * 7 + 5 Tip Conseguimos redimensionar um vetor usando o m\u00e9todo resize , que recebe o novo n\u00famero de elementos do vetor. Example Fa\u00e7a uma terceira vers\u00e3o de calcula_distancias , desta vez usando o layout de mem\u00f3ria acima. Verifique que o programa continua retornando os mesmos resultados que as vers\u00f5es anteriores. Question Rode novamente os testes de profiling e verifique o n\u00famero de instru\u00e7\u00f5es para esta nova vers\u00e3o. Compare este valor com os anteriores e comente.","title":"Matrizes (vers\u00e3o 2)"}]}